% mysetup.sty
\ProvidesPackage{mysetup}

% 加载宏包
\RequirePackage{fontspec} % 提供更灵活的字体设置
\RequirePackage{ctex} % 中文支持
\RequirePackage{silence} % 忽略警告
\RequirePackage{mathtools} % 提供了一些增强版的数学工具和数学环境
\RequirePackage{amsmath} % 提供了丰富的数学排版功能
\RequirePackage{amsfonts} % 提供了一些额外的数学字体
\RequirePackage{amssymb} % 提供了一些额外的数学符号
\RequirePackage{amsthm} % 用于排版定理、引理、证明等数学结构的宏包
\RequirePackage[T1]{fontenc} % 用于控制字体编码，常用选项包括 T1、T2A 等
\RequirePackage{indentfirst} % 段首空两格
\RequirePackage{graphicx} % 插入图片
\RequirePackage{geometry} % 设置页面布局
\RequirePackage{lastpage} % 总页数
\RequirePackage{latexsym} % 提供了一些额外的 LaTeX 符号
\RequirePackage{fancyhdr} % 页眉页脚
\RequirePackage{titlesec} % 自定义章节标题
\RequirePackage{setspace} % 设置行间距
\RequirePackage{enumerate} % 提供了丰富的列表环境
\RequirePackage{enumitem} % 提供了更多的列表环境控制
\RequirePackage{multicol} % 分栏
\RequirePackage{url} % 排版 URL
\RequirePackage{exscale} % 提供了数学公式的放大版本
\RequirePackage{ulem} % 提供了下划线、删除线等格式
\RequirePackage{relsize} % 在文档中设置局部字体大小
\RequirePackage{mathrsfs} % 提供了一些数学用的花体大写字母
\RequirePackage{tikz} % 绘图
\RequirePackage{wrapfig} % 图文绕排
\RequirePackage{framed} % 提供了一些带框的环境
\RequirePackage{bm} % 数学公式中的黑斜体, \bm{...}
\RequirePackage[all]{xy} % 绘制复杂的图表
\RequirePackage{extarrows} % 提供了更多的数学箭头
\RequirePackage{hyperref} % 提供超链接和书签功能
\RequirePackage{stfloats} % 插图的时候不分页
\RequirePackage{fancyhdr}
\RequirePackage{listings} % 代码排版
\RequirePackage{xcolor} % 颜色
\RequirePackage{algorithm} % 伪代码
\RequirePackage{algorithmicx} % 伪代码
\RequirePackage{algpseudocode} % 伪代码
\RequirePackage{mdframed} % 给定定理环境加边框
\RequirePackage{diagbox} % 斜线表头
\RequirePackage{makecell} % 合并单元格、在单元格内换行等
\usepackage{lmodern} % 使用 Latin Modern 字体
\usepackage{anyfontsize} % 提供任意字体大小
\usepackage[section]{placeins} % 控制浮动体位置
\usepackage{float} % 浮动体
\usepackage{bookmark} % 书签

\WarningFilter{latex}{Unused global option(s)} % 忽略警告

% 确保subsection计数器在section开始时重置
\makeatletter
\@addtoreset{subsection}{section}
\makeatother
% 定义公式编号格式：section.subsection.equation
\renewcommand{\theequation}{\arabic{section}.\thesubsection.\arabic{equation}}
% 确保equation计数器在subsection开始时重置
\makeatletter
\@addtoreset{equation}{subsection}
\makeatother

% 格式定义
\theoremstyle{definition} % 定义了一个名为 theoremstyle 的样式，用于定理环境的排版
\mdfdefinestyle{theoremstyle}{
    linecolor=green!50!blue!40!,linewidth=.5pt,
    backgroundcolor=green!50!blue!50!,
    skipabove=8pt,
    skipbelow=5pt,
    innerleftmargin=7pt,
    innerrightmargin=7pt,
    frametitlerule=true,
    frametitlerulewidth=.5pt,
    frametitlebackgroundcolor=green!40!blue!40!,
    frametitleaboveskip=0pt,
    frametitlebelowskip=0pt,
    innertopmargin=.4\baselineskip,
    innerbottommargin=.4\baselineskip,
    shadow=true,shadowsize=3pt,shadowcolor=black!10,
    theoremseparator={.},
    nobreak=true,
}

% \everymath{\displaystyle} % 设置行内公式默认为行间公式大小
\newtheorem{definition}{\hspace{2em}定义}[section] % 定义了一个名为 definition 的环墂，用于定义环境的排版
\newtheorem{axiom}{\hspace{2em}公理} % 定义了一个名为 axiom 的环境，用于公理环境的排版
\newtheorem{proposition}{\hspace{2em}命题} % 定义了一个名为 proposition 的环境，用于命题环境的排版

\mdtheorem[style=theoremstyle]{theorem}{定理} % 定义了一个名为 theorem 的环境，用于定理环境的排版
\mdtheorem[style=theoremstyle]{example}{例} % 定义了一个名为 example 的环境，用于例环境的排版
\mdtheorem[style=theoremstyle]{exercise}{问题} % 定义了一个名为 exercise 的环境，用于问题环境的排版

\newtheorem{lemma}[theorem]{\hspace{2em}引理} % 定义了一个名为 lemma 的环境，用于引理环境的排版
\newtheorem{corollary}[theorem]{\hspace{2em}推论} % 定义了一个名为 corollary 的环境，用于推论环境的排版


% 自定义命令
\renewcommand*{\proof}{\textbf{证明：}} % 重新定义了 proof 环境，使其显示为“证明：”
\newcommand*{\QED}{\hfill\ensuremath{\square}} % 定义了一个名为 QED 的命令，用于证毕符号
\newcommand*{\rmk}{\textbf{注：}} % 定义了一个名为 rmk 的命令，用于注释
\newcommand*{\tips}{\textbf{提示：}} % 定义了一个名为 tips 的命令，用于提示
\newcommand*{\hard}{\textbf{\color{red}(难)}} % 定义了一个名为 hard 的命令，用于标记难题
\newcommand*{\eqsmall}{\setlength\abovedisplayskip{1pt}\setlength\belowdisplayskip{1pt}} % 定义了一个名为 eqsmall 的命令，用于调整公式间距
\newcommand\e{\leftarrow}
% \renewcommand{\bibname}{参考文献}

% 设置页面布局
\setlength{\parindent}{2em} % 段首空两格
\linespread{1.2} % 行间距1.2倍
\geometry{left=25mm, right=25mm, top=25mm, bottom=25mm} % 设置页边距

\pagestyle{fancy} % 设置页眉页脚
\lhead{page \thepage} % 页眉左侧显示页数
\rhead{\small\leftmark} % 章节信息
\cfoot{\thepage\ of \pageref{LastPage}} % 当前页，记得调用前文提到的宏包
\renewcommand{\headrulewidth}{0.1mm} % 页眉线宽，设为 0 可以去页眉线
\renewcommand{\footrulewidth}{0mm} % 页脚线宽，设为 0 可以去页脚线

\setlength{\headheight}{14pt} % 设置页眉高度
\addtolength{\topmargin}{-2pt} % 设置页眉与正文的距离

\renewcommand{\thesection}{\Roman{section}} % Roman numerals ofr the sections
\renewcommand{\thesubsection}{\arabic{subsection}} % Arabic numerals ofr the sections
\titleformat{\section}{\bfseries\Large}{$\S$\,\thesection\,}{1em}{} % 更改标题样式

\setenumerate[1]{itemsep=0pt,partopsep=0pt,parsep=\parskip,topsep=0pt} % 设置 enumerate 行间距
\setenumerate[2]{itemsep=0pt,partopsep=0pt,parsep=\parskip,topsep=0pt} % 设置 enumerate 行间距
\setitemize[1]{itemsep=0pt,partopsep=0pt,parsep=\parskip,topsep=0pt} % 设置 itemize 行间距
\setlist[enumerate,2]{label=(\arabic*),topsep=0mm,itemsep=0mm,partopsep=0mm,parsep=\parskip} % 设置二层枚举为(1)样式

\lstset{
    numbers=left,
    language=Python,
    keywordstyle=\color{blue!100},
    commentstyle=\color{green!50!blue!50!},
    stringstyle=\color{purple},
    frame=shadowbox， % 阴影
    escapeinside=''， % 英文分号输入中文
    xleftmargin=2em，
    xrightmargin=2em,
    aboveskip=1em,
    framexleftmargin=2em,
    extendedchars=false,
    breaklines=true, % 自动换行
    postbreak=\mbox{\textcolor{red}{$\hookrightarrow$}\space}, % 换行符的样式
    showstringspaces=false % 不显示字符串中的空格标记
}

\endinput
